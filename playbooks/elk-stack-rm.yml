# Ce playbook déploie elk en Haute disponibilité sur un cluster
# Il déploie un agent elasticsearch, metricbeat et filebeat sur chaque noeud de la swarm ainsi que l'interface kibana sur un seul noeud de la swarm
# Ce role est a lancer seulement après avoir installé docker et docker compose, initialisé la swarm et configuré du stockage
- name: Deploy Elastic Stack
  hosts: [srv-elk-swarm-01]
  become: true
  vars:
    network_name: elk
    # share_name:
    repo_url: "ssh://git@ssh.github.com:443/NTE-Airport-DSI/docker-elk.git"
    repo_dest: "/opt/docker-elk"
    script_path: "./swarm-rm.sh"

  roles:
    - elk-stack-rm
